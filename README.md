# 🦾 Dobot 로봇팔 제어 시스템 v2.0

**경량화되고 개선된 Dobot 로봇팔 제어 시스템**

이 프로젝트는 Dobot 로봇팔을 제어하기 위한 현대적이고 직관적인 GUI 애플리케이션입니다. 실제 로봇이 연결되지 않은 경우 시뮬레이션 모드로 동작하여 모든 기능을 테스트할 수 있습니다.

## ✨ 주요 개선사항 (v2.0)

### 🎯 해결된 문제점들
- ✅ **출시예정 기능 제거**: 불필요한 출시예정 기능들을 제거하여 시스템 안정화
- ✅ **YOLOv8 객체 인식 유지**: 실용적인 YOLOv8 기반 실시간 객체 감지 기능 보강
- ✅ **좌표 동기화 문제 해결**: 수동 제어와 버튼 조작 간 좌표 호환성 개선
- ✅ **로봇 연결 상태 개선**: 시뮬레이션과 실제 로봇 모드를 명확히 분리
- ✅ **GUI 인터페이스 현대화**: 직관적이고 사용하기 쉬운 인터페이스로 개선

### 🚀 새로운 기능들
- 🎮 **향상된 시뮬레이션 모드**: 실제 로봇 없이도 모든 기능 테스트 가능
- 📹 **실시간 YOLOv8 객체 감지**: 카메라를 통한 실시간 가구 인식 및 자동 픽업
- 🔄 **실시간 좌표 동기화**: 수동 입력과 자동 제어 간 완벽한 동기화
- 📊 **통합 로깅 시스템**: 파일, 콘솔, GUI 로그를 통합 관리
- 🛡️ **강화된 에러 처리**: 자동 복구 및 사용자 친화적 오류 메시지
- ⚙️ **모듈화된 코드 구조**: 유지보수가 쉬운 깔끔한 코드 구조

## 📁 프로젝트 구조

```
dobot_project/
├── 📄 main.py              # 메인 애플리케이션
├── 🤖 robot_controller.py  # 로봇 제어 클래스 (시뮬레이션 + 실제)
├── 👁️ yolo_detector.py     # YOLOv8 객체 인식 시스템
├── 🖼️ ui_components.py     # 현대적인 GUI 컴포넌트
├── ⚙️ config.py           # 시스템 설정 및 상수
├── 🔧 utils.py            # 유틸리티 함수 및 헬퍼 클래스
├── 📝 logger_setup.py     # 통합 로깅 시스템
├── 🚀 run.py              # 간편한 실행 스크립트
├── 🧪 test_system.py      # 시스템 테스트 스크립트
├── 📦 requirements.txt    # 필요한 패키지 목록
├── 📖 README.md          # 이 파일
└── 📂 logs/              # 로그 파일들 (자동 생성)
```

## 🛠️ 설치 및 실행

### 1. 필수 요구사항
- **Python 3.8 이상**
- **Windows 10/11** (권장, Linux/macOS도 지원)
- **웹캠** (선택사항)
- **Dobot 로봇** (선택사항, 없으면 시뮬레이션 모드)

### 2. 패키지 설치

```bash
# 기본 패키지 설치
pip install -r requirements.txt

# 또는 개별 설치
pip install numpy matplotlib PyYAML opencv-python pillow ultralytics

# 실제 로봇 사용 시 (선택적)
pip install pydobot pyserial
```

### 3. 실행 방법

```bash
# 기본 실행 (시뮬레이션 모드)
python run.py

# 또는 직접 실행
python main.py

# 디버그 모드
python run.py --debug

# 실제 로봇 연결 시도
python run.py --real

# 시뮬레이션 모드 강제
python run.py --simulation
```

## 🎮 사용 방법

### 기본 조작
1. **좌표 이동**: X, Y, Z, R 값을 입력하고 "이동" 버튼 클릭
2. **가구 픽업**: 좌측 패널의 컬러 버튼(소파, 의자, 책상, 침대) 클릭
3. **그리퍼 제어**: "그리퍼 토글" 버튼으로 열기/닫기
4. **홈 위치**: "홈" 버튼으로 기본 위치로 이동

### YOLOv8 객체 인식 기능
1. **카메라 시작**: 중앙 패널의 "카메라 시작" 버튼 클릭
2. **실시간 감지**: 카메라 화면에서 실시간 객체 감지 및 바운딩 박스 표시
3. **객체 선택**: 우측 감지 목록에서 원하는 객체 선택
4. **자동 픽업**: "선택된 객체 픽업" 버튼으로 자동 픽업 시퀀스 실행
5. **위치 이동**: "선택된 객체로 이동" 버튼으로 해당 위치로 이동

### 고급 기능
- **현재 위치 동기화**: "현재 위치 가져오기" 버튼으로 좌표 필드 업데이트
- **로봇 연결**: "로봇 연결" 버튼으로 실제 로봇 연결 시도
- **시스템 리셋**: "시스템 리셋" 버튼으로 전체 시스템 초기화
- **비상 정지**: 빨간색 "비상 정지" 버튼으로 즉시 정지

### 좌표 시스템
- **X축**: -400 ~ 400 mm (좌우)
- **Y축**: -400 ~ 400 mm (앞뒤)  
- **Z축**: -100 ~ 200 mm (상하)
- **R축**: -180 ~ 180 도 (회전)

## 🔧 설정 및 커스터마이징

### 로봇 연결 설정 (`config.py`)
```python
# 로봇 IP 주소 (실제 로봇 사용 시 변경)
ROBOT_IP = "192.168.1.6"
DASHBOARD_PORT = 29999
MOVE_PORT = 30003
```

### 가구 위치 설정
가구별 픽업 및 배치 좌표는 `config.py`의 `FURNITURE_POSITIONS`에서 수정 가능:

```python
FURNITURE_POSITIONS = {
    "sofa": {
        "pickup": [300.0, 100.0, 20.0, 0.0],
        "place": [350.0, 0.0, 30.0, 0.0]
    },
    # ... 다른 가구들
}
```

## 🔍 문제 해결

### 일반적인 문제들

#### 1. "ModuleNotFoundError" 오류
```bash
# 해결방법: 필요한 패키지 설치
pip install -r requirements.txt
```

#### 2. "로봇 연결 실패" 메시지
- **시뮬레이션 모드 사용**: 실제 로봇 없이도 모든 기능 사용 가능
- **네트워크 확인**: 로봇과 컴퓨터가 같은 네트워크에 있는지 확인
- **IP 주소 확인**: `config.py`에서 올바른 로봇 IP 설정

#### 3. 좌표 이동 실패
- **작업 영역 확인**: 좌표가 설정된 범위 내에 있는지 확인
- **로봇 상태 확인**: 비상 정지가 활성화되어 있지 않은지 확인

#### 4. GUI 표시 문제
- **tkinter 설치 확인**: Python과 함께 설치되지 않은 경우 별도 설치 필요
- **해상도 확인**: 최소 800x600 해상도 필요

### 로그 확인
문제 발생 시 다음 위치의 로그 파일을 확인하세요:
- `logs/dobot_system.log`: 일반 로그
- `logs/debug.log`: 디버그 로그 (디버그 모드 시)

## 🔗 네트워크 설정 (실제 로봇 사용 시)

### 유선 연결
- **LAN1**: 192.168.5.1
- **LAN2**: 192.168.200.1

### 무선 연결  
- **WiFi**: 192.168.9.1

### 연결 테스트
```bash
# 로봇 연결 상태 확인
ping 192.168.1.6
```

## 🎯 기능 명세

### 시뮬레이션 모드
- ✅ 모든 GUI 기능 동작
- ✅ 가상 좌표 이동
- ✅ 그리퍼 시뮬레이션
- ✅ 픽업 시퀀스 테스트
- ✅ 실시간 로그 확인
- ✅ YOLOv8 객체 감지 (카메라 연결 시)

### 실제 로봇 모드
- ✅ TCP/IP 통신을 통한 로봇 제어
- ✅ 실시간 위치 피드백
- ✅ 안전한 이동 시퀀스
- ✅ 에러 감지 및 복구
- ✅ 비상 정지 기능
- ✅ YOLOv8 기반 자동 객체 픽업

### YOLOv8 객체 인식 시스템
- 🎯 **지원 객체**: 의자, 소파, 침대, 책상, 책, 휴대폰 등 15개 클래스
- 📹 **실시간 감지**: 30 FPS 실시간 객체 감지 및 바운딩 박스 표시
- 🎯 **정확한 위치**: 픽셀 좌표를 로봇 작업 공간 좌표로 정확히 변환
- 🤖 **자동 픽업**: 감지된 객체를 클릭 한 번으로 자동 픽업
- 🔄 **실시간 업데이트**: 감지 결과를 실시간으로 GUI에 표시

### 자동 픽업 시퀀스
각 가구별로 다음 단계를 자동 실행:
1. 안전 높이로 이동
2. 그리퍼 열기
3. 타겟 위치로 하강
4. 그리퍼 닫기 (물체 집기)
5. 안전 높이로 상승
6. 배치 위치로 이동
7. 하강 후 그리퍼 열기
8. 안전 높이로 복귀

## 🔄 업데이트 히스토리

### v2.0.0 (2025-07-27)
- **주요 리팩토링**: 전체 코드 구조 개선
- **출시예정 기능 제거**: 불안정한 출시예정 기능들 제거로 시스템 안정화
- **YOLOv8 객체 인식**: 실용적인 실시간 객체 감지 및 자동 픽업 기능 강화
- **좌표 동기화**: 수동/자동 제어 간 좌표 호환성 개선
- **GUI 현대화**: 3패널 레이아웃 및 실시간 카메라 화면 추가
- **모듈화**: 유지보수가 쉬운 모듈 구조
- **로깅 개선**: 통합 로깅 시스템 구축
- **에러 처리**: 강화된 에러 처리 및 복구 시스템

### v1.0 (2025-07-25)
- 기본 로봇 제어 기능
- YOLOv8 객체 인식 (출시예정 기능들과 혼재)
- 기본적인 GUI 인터페이스

## 📞 지원 및 문의

- **버그 리포트**: [johyunsu61@gmail.com](mailto:johyunsu61@gmail.com)
- **기능 개선 제안**: GitHub Issues
- **사용법 문의**: README 참조 또는 이메일 문의

## 🙏 감사의 말

- Dobot 커뮤니티의 피드백과 제안
- 오픈소스 라이브러리 개발자들
- Python 및 tkinter 개발팀

---

**💡 참고**: 
- 실제 Dobot 로봇 없이도 시뮬레이션 모드로 모든 기능을 테스트하고 학습할 수 있습니다!
- YOLOv8 객체 인식은 웹캠이 연결된 환경에서 사용 가능합니다.
- 카메라가 없어도 모든 로봇 제어 기능은 정상적으로 동작합니다.
